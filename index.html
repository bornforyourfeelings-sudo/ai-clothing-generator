<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No One Else Has This</title>
    <style>
        body {font-family:Arial;background:#000;color:#fff;text-align:center;padding:30px;}
        h1 {font-size:2.8em;background:linear-gradient(90deg,#ff00aa,#00ffff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
        input[type=text],select {width:90%;max-width:600px;padding:18px;margin:10px;font-size:1.4em;border:3px solid #ff00aa;border-radius:15px;background:#111;color:white;}
        input[type=submit] {padding:18px 60px;font-size:1.6em;background:#ff00aa;border:none;border-radius:50px;cursor:pointer;}
        .result {margin:60px auto;max-width:600px; display: none;}
        img {width:100%;border-radius:20px;margin:20px 0;box-shadow:0 0 40px #ff00aa88;}
        button {margin:15px 0;padding:16px;width:100%;font-size:1.3em;border:none;border-radius:40px;cursor:pointer;}
        .produce {background:#25d366;color:white;font-weight:bold;}
    </style>
</head>
<body>
    <h1>No One Else Has This</h1>
    <p>Describe your dream clothing — China makes it real</p>
    <form id="clothing-form">
        <input type="text" name="prompt" placeholder="Describe your dream clothing..." required>
        <select name="size">
            <option>XS</option>
            <option>S</option>
            <option selected>M</option>
            <option>L</option>
            <option>XL</option>
            <option>XXL</option>
        </select>
        <input type="text" name="qty" placeholder="Quantity" value="1">
        <input type="submit" value="Generate">
    </form>
    <div id="result" class="result"></div>

    <script>
        document.getElementById('clothing-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const prompt = document.querySelector('input[name="prompt"]').value.trim();
            const size = document.querySelector('select[name="size"]').value;
            const qty = document.querySelector('input[name="qty"]').value || '1';

            const encoded_prompt = encodeURIComponent(`${prompt}, fashion product photo, white background, studio lighting, ultra detailed, 8k`);
            const url = `https://image.pollinations.ai/prompt/${encoded_prompt}?model=flux&width=1024&height=1024`;

            try {
                const res = await fetch(url);
                if (!res.ok) throw new Error('Image generation failed');
                const blob = await res.blob();
                const reader = new FileReader();
                reader.readAsDataURL(blob);
                reader.onload = async function() {
                    const img_src = reader.result;
                    const img_b64 = img_src.split(',')[1];

                    let img_url = `data:image/png;base64,${img_b64}`;
                    try {
                        const formData = new FormData();
                        formData.append('key', '10b08c5be2b4f6c9a2f1d2e8f7c3e4a5');
                        formData.append('image', img_b64);
                        const uploadRes = await fetch('https://api.imgbb.com/1/upload', { method: 'POST', body: formData });
                        if (!uploadRes.ok) throw new Error('Upload failed');
                        const uploadData = await uploadRes.json();
                        if (uploadData.data && uploadData.data.url) {
                            img_url = uploadData.data.url;
                        }
                    } catch (uploadError) {
                        console.error('Upload to imgbb failed:', uploadError);
                    }

                    const FACTORY_WHATSAPP = "+8615808103712";
                    const YOUR_REFERRAL_CODE = "REF_GROK2025";
                    const message = `Hello MMS Clothing!\nFully custom clothing — cut & sew\nReferral: ${YOUR_REFERRAL_CODE} → 25% cashback\nDesign:\n${img_url}\nDescription: ${prompt}\nSize: ${size} | Quantity: ${qty} pc(s)\nPlease send quote + sample cost + lead time.\nThank you!`;
                    const phone = FACTORY_WHATSAPP.replace('+', '');
                    const encoded_message = encodeURIComponent(message);
                    const wa_link = `https://api.whatsapp.com/send?phone=${phone}&text=${encoded_message}`;

                    const resultDiv = document.getElementById('result');
                    resultDiv.innerHTML = `
                        <img src="${img_src}" alt="Generated Image">
                        <button class="produce" onclick="window.open('${wa_link}')"> Produce in China — $32–48 </button>
                    `;
                    resultDiv.style.display = 'block';
                };
            } catch (error) {
                console.error('Error:', error);
                alert('An error occurred. Please try again.');
            }
        });
    </script>
</body>
</html>
